{% extends 'base.html.twig' %}

{% block title %}Hello MagazineController!{% endblock %}

{% block body %}

    {% for message in app.flashes('success') %}

                <div class = "alert alert-success">
                    {{ message }}
                </div>
                
    {% endfor %}

    <div class='container px-4'>
        <div class="row gx-5">
            <div class="col">
                <a class='btn btn-dark m-4' href="{{ path('app_magazine_new') }}"> Add +</a>
            </div>
            <div class="col m-4">
                <form method="GET">
                    <label for="numbers">Nombre de magazines par page</label>
                    <input type="hidden" name="page" value=" {{ app.request.query.get("page", 1) }}">
                    <select name="numbers" id="numbers" onchange ="this.form.submit();">
                        <option value="5">Choisissez une option</option>
                        <option value="5">5</option>
                        <option value="3">3</option>
                        <option value="1">1</option>
                    </select>
                </form>
            </div>
        </div>    
    </div>

    <table class='table table-dark table-hover w-50 m-auto'>
        <thead>
            <tr>    
                <th>Name</th>
                <th>Détails</th>
                <th>Image</th>
                <th>Edier</th>
                <th>Supprimer</th>
                
                
            </tr>
        </thead>
        <tbody>
            {% for magazine in magazines %}
                <tr>
                    <td>{{ magazine.name }}</td>
                    <td>
                        {# Si l'image existe, on l'affiche en appliquant un filtre #}
                        {% if vich_uploader_asset(magazine, 'profileFile') is not null %}
                            <img src="{{ vich_uploader_asset(magazine, 'profileFile')|imagine_filter('thumbnail') }}" alt="{{ magazine.name }}">
                        {% endif %}
                    </td>
                    <td> {{ magazine.stock.name }} </td>
                    <td>
                        <a href= "{{ path('app_id', { id:magazine.id }) }}">Voir plus de détails...</a>
                    </td>
                    <td><a href="{{ path('app_magazine_edit', { id:magazine.id }) }}"><button>Editer</button></a></td>
                    <td>
                         <form action="{{ path('app_magazine_delet', { id:magazine.id }) }}" method="post">
                            <input type="hidden" name='token' value="{{ csrf_token('delet-magazine-'~ magazine.id) }}">
                            <button type="button" data-bs-toggle="modal" data-bs-target="#exampleModal">Supprimer</button>
                        </form>
                        
                    </td>
                     
            {% endfor %}

        </tbody> 
        
    </table>

        {{ knp_pagination_render(magazines) }}

        <a class="btn btn-dark m-5" href="{{ path('app_categorie') }}"> Mes categories </a>

{% endblock %}
